

import hashlib
a_string = 'this string holds important and private information'
# hashed_string = hashlib.sha256(a_string.encode('utf-8')).hexdigest()
# print(hashed_string)
# p=hashlib.sha256(open('/home/omar/PycharmProjects/pythonProject2/dist/malwareeeeeeeee','rb').read()).hexdigest()


database ='40ccfed4ee31237768f3fc01504536d69230eed0edfa29ff34d3c3104aedd617'

scanned= {'processName':[],'processID':[],'exe_path':[]};

scan=[]
import psutil
# Iterate over all running process
for proc in psutil.process_iter():
    try:
        # Get process name & pid from process object.
        processName = proc.name()
        processID = proc.pid
        exe_path=proc.exe()
        # print(processName , ' ::: ', processID,exe_path)
        scanned['processName'].append(processName)
        scanned['processID'] .append(processID)
        scanned['exe_path'] .append(exe_path)
        scan.append(scanned)
    except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
        pass

print(scanned)

for i in range(len(scanned['exe_path'])):
    # print(process)
    try:
        h = hashlib.sha256(open(scanned['exe_path'][i], 'rb').read()).hexdigest()
        # print (h)
        if h == database:
            print("there is a malware in this path {}".format(scanned['exe_path'][i]))
            pid=scanned['processID'][i]
            p = psutil.Process(pid)
            p.terminate()
    except:
        pass
