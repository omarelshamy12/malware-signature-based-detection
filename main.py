
import hashlib
# from database_generation import database
database=['1fa745fb18402deeb2c069f7a40f93ea98729305e65d65e0f1cf0e299bf9880b', '40ccfed4ee31237768f3fc01504536d69230eed0edfa29ff34d3c3104aedd617', 'ce94e4f6ccecc48707f7efb4453421d798fe7850e776d5e7cddc9a7f5f3bd701', '12012bf1a81ab6094625921b7173d4577c1cce787cecff3fcaeef6241fb90879']
scanned= {'processName':[],'processID':[],'exe_path':[]};
scan=[]
import psutil
# Iterate over all running process
for proc in psutil.process_iter():
    try:
        # Get process name & pid & exe path from process object.
        processName = proc.name()
        processID = proc.pid
        exe_path=proc.exe()
        print(processName , ' ::: ', processID,' ::: ',exe_path)
        scanned['processName'].append(processName)
        scanned['processID'] .append(processID)
        scanned['exe_path'] .append(exe_path)
        scan.append(scanned)
    except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
        pass
malwares = []
name=[]

print("-----------------------------------------------------------------------------------------\n")
print("scanning for malwares now......\n")
for i in range(len(scanned['exe_path'])):
    # print(process)
    try:
        exe = scanned['exe_path'][i]
        h = hashlib.sha256(open(exe, 'rb').read()).hexdigest()
        # print (h)
        if h in database:
            pid=scanned['processID'][i]
            p = psutil.Process(pid)
            p.terminate()
            if exe not in malwares:
                malwares.append(exe)
                name.append(scanned["processName"][i])
    except:
        pass
if not len(malwares):
    print("your device is clean\n")
for i in range(len(malwares)):
    print("there is a malware named {} in the path: {}".format(name[i],malwares[i]))
    print("the scanner killed it successfully \n")
    print("=====================================================")